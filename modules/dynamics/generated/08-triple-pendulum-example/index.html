<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <title>
Triple Pendulum Example | Foldable Robotics
</title>

    <link href="/css/bootstrap.min.css" rel="stylesheet">

<style>
  .bd-placeholder-img {
    font-size: 1.125rem;
    text-anchor: middle;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }

  @media (min-width: 768px) {
    .bd-placeholder-img-lg {
      font-size: 3.5rem;
    }
  }
</style>

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Oleo+Script:wght@400;700&display=swap" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet"> 


<link href="/css/blog.css" rel="stylesheet">
<link href="/css/features.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">


    <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <link rel="stylesheet" type="text/css" href="/hugo-cite.css" />

    <link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
<link rel="manifest" href="/favicon/manifest.json">


  </head>
  <body>

    <div class="container">

      <header class="blog-header py-3">
  <div class="row flex-nowrap justify-content-between align-items-center">
    <div class="col-2 pt-1">
    </div>
    <div class="col-8 text-center">
      <a class="blog-header-logo text-dark" href="/">Foldable Robotics</a>
    </div>
    <div class="col-2 d-flex justify-content-end align-items-center">
    </div>
  </div>
</header>


      <nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Home</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        
        
        
        
        
      
        <li class="nav-item">
          <a class="nav-link" href="/assignments/">Assignments</a>
        </li>
        
        
        
        
        
      
        <li class="nav-item">
          <a class="nav-link" href="/calendar/">Course Calendar</a>
        </li>
        
        
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="/course-documents/" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Course Documents
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            
            <li><a class="dropdown-item" href="/course-documents/software-list/">Software List</a></li>
            
            <li><a class="dropdown-item" href="/course-documents/submission-best-practices/">Submission Best Practices</a></li>
            
            <li><a class="dropdown-item" href="/course-documents/suggested-materials-list/">Suggested Materials List</a></li>
            
            <li><a class="dropdown-item" href="/course-documents/syllabus-web/">Syllabus for Foldable Robotics</a></li>
            
          </ul>
        </li>
        
        
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="/modules/" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Course Topics
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            
            <li><a class="dropdown-item" href="/modules/biomechanics/">Biomechanics &amp; Bio-inspiration</a></li>
            
            <li><a class="dropdown-item" href="/modules/dynamics/">Dynamics</a></li>
            
            <li><a class="dropdown-item" href="/modules/validation/">Experimental Validation</a></li>
            
            <li><a class="dropdown-item" href="/modules/integration/">Integration</a></li>
            
            <li><a class="dropdown-item" href="/modules/introduction/">Introduction</a></li>
            
            <li><a class="dropdown-item" href="/modules/kinematics/">Kinematics</a></li>
            
            <li><a class="dropdown-item" href="/modules/compliance/">Mechanics and Compliance</a></li>
            
            <li><a class="dropdown-item" href="/modules/misc/">Misc</a></li>
            
            <li><a class="dropdown-item" href="/modules/optimization/">Optimization</a></li>
            
            <li><a class="dropdown-item" href="/modules/project/">Project</a></li>
            
            <li><a class="dropdown-item" href="/modules/manufacturing/">Prototyping &amp; Manufacturing</a></li>
            
            <li><a class="dropdown-item" href="/modules/python/">Python</a></li>
            
          </ul>
        </li>
        
        
        
        
        
      
        <li class="nav-item">
          <a class="nav-link" href="/lectures/">Lectures</a>
        </li>
        
        
        
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://canvas.asu.edu/"target="_blank">Canvas <i class="bi bi-link"></i></a> 
        </li>
        
        
      </ul>
      <span class="navbar-text">
        Making better Foldable Robots
      </span>

    </div>
  </div>
</nav>

    </div>

    
<main class="container">
  <article>
  <h1>Default Single Page: Triple Pendulum Example</h1>
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>matplotlib inline
</code></pre></div><p>Try running with this variable set to true and to false and see the difference in the resulting equations of motion</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">global_q <span style="color:#f92672">=</span> False
use_constraints <span style="color:#f92672">=</span> False
</code></pre></div><p>Import all the necessary modules</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">Written by Daniel M. Aukes
</span><span style="color:#e6db74">Email: danaukes&lt;at&gt;gmail.com
</span><span style="color:#e6db74">Please see LICENSE for full license.
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#f92672">import</span> pynamics
<span style="color:#f92672">from</span> pynamics.frame <span style="color:#f92672">import</span> Frame
<span style="color:#f92672">from</span> pynamics.variable_types <span style="color:#f92672">import</span> Differentiable,Constant
<span style="color:#f92672">from</span> pynamics.system <span style="color:#f92672">import</span> System
<span style="color:#f92672">from</span> pynamics.body <span style="color:#f92672">import</span> Body
<span style="color:#f92672">from</span> pynamics.dyadic <span style="color:#f92672">import</span> Dyadic
<span style="color:#f92672">from</span> pynamics.output <span style="color:#f92672">import</span> Output,PointsOutput
<span style="color:#f92672">from</span> pynamics.particle <span style="color:#f92672">import</span> Particle
<span style="color:#f92672">import</span> pynamics.integration
<span style="color:#f92672">import</span> numpy
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
plt<span style="color:#f92672">.</span>ion()
<span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> pi
</code></pre></div><p>The next two lines create a new system object and set that system as the global system within the module so that other variables can use and find it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">system <span style="color:#f92672">=</span> System()
pynamics<span style="color:#f92672">.</span>set_system(__name__,system)
</code></pre></div><h2 id="parameterization">Parameterization</h2>
<h3 id="constants">Constants</h3>
<p>Declare constants and seed them with their default value.  This can be changed at integration time but is often a nice shortcut when you don&rsquo;t want the value to change but you want it to be represented symbolically in calculations</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">lA <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;lA&#39;</span>,system)
lB <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;lB&#39;</span>,system)
lC <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;lC&#39;</span>,system)

mA <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;mA&#39;</span>,system)
mB <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;mB&#39;</span>,system)
mC <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;mC&#39;</span>,system)

g <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">9.81</span>,<span style="color:#e6db74">&#39;g&#39;</span>,system)
b <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1e1</span>,<span style="color:#e6db74">&#39;b&#39;</span>,system)
k <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1e1</span>,<span style="color:#e6db74">&#39;k&#39;</span>,system)

preload1 <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>,<span style="color:#e6db74">&#39;preload1&#39;</span>,system)
preload2 <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>,<span style="color:#e6db74">&#39;preload2&#39;</span>,system)
preload3 <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>,<span style="color:#e6db74">&#39;preload3&#39;</span>,system)

Ixx_A <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Ixx_A&#39;</span>,system)
Iyy_A <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Iyy_A&#39;</span>,system)
Izz_A <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Izz_A&#39;</span>,system)
Ixx_B <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Ixx_B&#39;</span>,system)
Iyy_B <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Iyy_B&#39;</span>,system)
Izz_B <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Izz_B&#39;</span>,system)
Ixx_C <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Ixx_C&#39;</span>,system)
Iyy_C <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Iyy_C&#39;</span>,system)
Izz_C <span style="color:#f92672">=</span> Constant(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Izz_C&#39;</span>,system)
</code></pre></div><h2 id="integration-tolerance">Integration Tolerance</h2>
<p>Specify the precision of the integration</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tol <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e-12</span>
</code></pre></div><h3 id="time">Time</h3>
<p>Define variables for time that can be used throughout the script.  These get used to create the t array, a list of every time value that is solved for during integration</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tinitial <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
tfinal <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
fps <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>
tstep <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>fps
t <span style="color:#f92672">=</span> numpy<span style="color:#f92672">.</span>r_[tinitial:tfinal:tstep]
</code></pre></div><h3 id="differentiable-state-variables">Differentiable State Variables</h3>
<p>Define your differentiable state variables that you will use to model the state of the system.  In this case $qA$, $qB$, and $qC$ are the rotation angles of a three-link mechanism</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">qA,qA_d,qA_dd <span style="color:#f92672">=</span> Differentiable(<span style="color:#e6db74">&#39;qA&#39;</span>,system)
qB,qB_d,qB_dd <span style="color:#f92672">=</span> Differentiable(<span style="color:#e6db74">&#39;qB&#39;</span>,system)
qC,qC_d,qC_dd <span style="color:#f92672">=</span> Differentiable(<span style="color:#e6db74">&#39;qC&#39;</span>,system)
</code></pre></div><h3 id="initial-values">Initial Values</h3>
<p>Define a set of initial values for the position and velocity of each of your state variables.  It is necessary to define a known.  This code create a dictionary of initial values.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">initialvalues <span style="color:#f92672">=</span> {}
initialvalues[qA]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>
initialvalues[qA_d]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>
initialvalues[qB]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>
initialvalues[qB_d]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>
initialvalues[qC]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>
initialvalues[qC_d]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>
</code></pre></div><p>These two lines of code order the initial values in a list in such a way that the integrator can use it in the same order that it expects the variables to be supplied</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">statevariables <span style="color:#f92672">=</span> system<span style="color:#f92672">.</span>get_state_variables()
ini <span style="color:#f92672">=</span> [initialvalues[item] <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> statevariables]
</code></pre></div><h2 id="kinematics">Kinematics</h2>
<h3 id="frames">Frames</h3>
<p>Define the reference frames of the system</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">N <span style="color:#f92672">=</span> Frame(<span style="color:#e6db74">&#39;N&#39;</span>)
A <span style="color:#f92672">=</span> Frame(<span style="color:#e6db74">&#39;A&#39;</span>)
B <span style="color:#f92672">=</span> Frame(<span style="color:#e6db74">&#39;B&#39;</span>)
C <span style="color:#f92672">=</span> Frame(<span style="color:#e6db74">&#39;C&#39;</span>)
</code></pre></div><h3 id="newtonian-frame">Newtonian Frame</h3>
<p>It is important to define the Newtonian reference frame as a reference frame that is not accelerating, otherwise the dynamic equations will not be correct</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">system<span style="color:#f92672">.</span>set_newtonian(N)
</code></pre></div><p>This is the first time that the &ldquo;global_q&rdquo; variable is used.  If you choose to rotate each frame with reference to the base frame, there is the potential for a representational simplification.  If you use a relative rotation, this can also be simpler in some cases.  Try running the code either way to see which one is simpler in this case.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> global_q:
    A<span style="color:#f92672">.</span>rotate_fixed_axis_directed(N,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>],qA,system)
    B<span style="color:#f92672">.</span>rotate_fixed_axis_directed(A,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>],qB,system)
    C<span style="color:#f92672">.</span>rotate_fixed_axis_directed(B,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>],qC,system)
<span style="color:#66d9ef">else</span>:
    A<span style="color:#f92672">.</span>rotate_fixed_axis_directed(N,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>],qA,system)
    B<span style="color:#f92672">.</span>rotate_fixed_axis_directed(N,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>],qB,system)
    C<span style="color:#f92672">.</span>rotate_fixed_axis_directed(N,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>],qC,system)
</code></pre></div><h3 id="vectors">Vectors</h3>
<p>Define the vectors that describe the kinematics of a series of connected lengths</p>
<ul>
<li>pNA - This is a vector with position at the origin.</li>
<li>pAB - This vector is length $l_A$ away from the origin along the A.x unit vector</li>
<li>pBC - This vector is length $l_B$ away from the pAB along the B.x unit vector</li>
<li>pCtip - This vector is length $l_C$ away from the pBC along the C.x unit vector</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pNA<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">*</span>N<span style="color:#f92672">.</span>x
pAB<span style="color:#f92672">=</span>pNA<span style="color:#f92672">+</span>lA<span style="color:#f92672">*</span>A<span style="color:#f92672">.</span>x
pBC <span style="color:#f92672">=</span> pAB <span style="color:#f92672">+</span> lB<span style="color:#f92672">*</span>B<span style="color:#f92672">.</span>x
pCtip <span style="color:#f92672">=</span> pBC <span style="color:#f92672">+</span> lC<span style="color:#f92672">*</span>C<span style="color:#f92672">.</span>x
</code></pre></div><h2 id="centers-of-mass">Centers of Mass</h2>
<p>It is important to define the centers of mass of each link.  In this case, the center of mass of link A, B, and C is halfway along the length of each</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pAcm<span style="color:#f92672">=</span>pNA<span style="color:#f92672">+</span>lA<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>A<span style="color:#f92672">.</span>x
pBcm<span style="color:#f92672">=</span>pAB<span style="color:#f92672">+</span>lB<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>B<span style="color:#f92672">.</span>x
pCcm<span style="color:#f92672">=</span>pBC<span style="color:#f92672">+</span>lC<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>C<span style="color:#f92672">.</span>x
</code></pre></div><h2 id="calculating-velocity">Calculating Velocity</h2>
<p>The angular velocity between frames, and the time derivatives of vectors are extremely useful in calculating the equations of motion and for determining many of the forces that need to be applied to your system (damping, drag, etc).  Thus, it is useful, once kinematics have been defined, to take or find the derivatives of some of those vectors for calculating  linear or angular velocity vectors</p>
<h3 id="angular-velocity">Angular Velocity</h3>
<p>The following three lines of code computes and returns the angular velocity between frames N and A (${}^N\omega^A$), A and B (${}^A\omega^B$), and B and C (${}^B\omega^C$).  In other cases, if the derivative expression is complex or long,  you can supply pynamics with a given angular velocity between frames to speed up computation time.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">wNA <span style="color:#f92672">=</span> N<span style="color:#f92672">.</span>getw_(A)
wAB <span style="color:#f92672">=</span> A<span style="color:#f92672">.</span>getw_(B)
wBC <span style="color:#f92672">=</span> B<span style="color:#f92672">.</span>getw_(C)
</code></pre></div><h3 id="vector-derivatives">Vector derivatives</h3>
<p>The time derivatives of vectors may also be</p>
<p>vCtip = pCtip.time_derivative(N,system)</p>
<h3 id="define-inertias-and-bodies">Define Inertias and Bodies</h3>
<p>The next several lines compute the inertia dyadics of each body and define a rigid body on each frame.  In the case of frame C, we represent the mass as a particle located at point pCcm.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">IA <span style="color:#f92672">=</span> Dyadic<span style="color:#f92672">.</span>build(A,Ixx_A,Iyy_A,Izz_A)
IB <span style="color:#f92672">=</span> Dyadic<span style="color:#f92672">.</span>build(B,Ixx_B,Iyy_B,Izz_B)
IC <span style="color:#f92672">=</span> Dyadic<span style="color:#f92672">.</span>build(C,Ixx_C,Iyy_C,Izz_C)

BodyA <span style="color:#f92672">=</span> Body(<span style="color:#e6db74">&#39;BodyA&#39;</span>,A,pAcm,mA,IA,system)
BodyB <span style="color:#f92672">=</span> Body(<span style="color:#e6db74">&#39;BodyB&#39;</span>,B,pBcm,mB,IB,system)
<span style="color:#75715e">#BodyC = Body(&#39;BodyC&#39;,C,pCcm,mC,IC,system)</span>
BodyC <span style="color:#f92672">=</span> Particle(pCcm,mC,<span style="color:#e6db74">&#39;ParticleC&#39;</span>,system)
</code></pre></div><h2 id="forces-and-torques">Forces and Torques</h2>
<p>Forces and torques are added to the system with the generic <code>addforce</code> method.  The first parameter supplied is a vector describing the force applied at a point or the torque applied along a given rotational axis.  The second parameter is the  vector describing the linear speed (for an applied force) or the angular velocity(for an applied torque)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">system<span style="color:#f92672">.</span>addforce(<span style="color:#f92672">-</span>b<span style="color:#f92672">*</span>wNA,wNA)
system<span style="color:#f92672">.</span>addforce(<span style="color:#f92672">-</span>b<span style="color:#f92672">*</span>wAB,wAB)
system<span style="color:#f92672">.</span>addforce(<span style="color:#f92672">-</span>b<span style="color:#f92672">*</span>wBC,wBC)
</code></pre></div><pre><code>&lt;pynamics.force.Force at 0x2970ea59190&gt;
</code></pre>
<h3 id="spring-forces">Spring Forces</h3>
<p>Spring forces are a special case because the energy stored in springs is conservative and should be considered when calculating the system&rsquo;s potential energy.  To do this, use the <code>add_spring_force</code> command.  In this method, the first value is the linear spring constant.  The second value is the &ldquo;stretch&rdquo; vector, indicating the amount of deflection from the neutral point of the spring.  The final parameter is, as above, the linear or angluar velocity vector (depending on whether your spring is a linear or torsional spring)</p>
<p>In this case, the torques applied to each joint are dependent upon whether qA, qB, and qC are absolute or relative rotations, as defined above.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> global_q:
    system<span style="color:#f92672">.</span>add_spring_force1(k,(qA<span style="color:#f92672">-</span>preload1)<span style="color:#f92672">*</span>N<span style="color:#f92672">.</span>z,wNA) 
    system<span style="color:#f92672">.</span>add_spring_force1(k,(qB<span style="color:#f92672">-</span>preload2)<span style="color:#f92672">*</span>A<span style="color:#f92672">.</span>z,wAB)
    system<span style="color:#f92672">.</span>add_spring_force1(k,(qC<span style="color:#f92672">-</span>preload3)<span style="color:#f92672">*</span>B<span style="color:#f92672">.</span>z,wBC)
<span style="color:#66d9ef">else</span>:
    system<span style="color:#f92672">.</span>add_spring_force1(k,(qA<span style="color:#f92672">-</span>preload1)<span style="color:#f92672">*</span>N<span style="color:#f92672">.</span>z,wNA) 
    system<span style="color:#f92672">.</span>add_spring_force1(k,(qB<span style="color:#f92672">-</span>qA<span style="color:#f92672">-</span>preload2)<span style="color:#f92672">*</span>N<span style="color:#f92672">.</span>z,wAB)
    system<span style="color:#f92672">.</span>add_spring_force1(k,(qC<span style="color:#f92672">-</span>qB<span style="color:#f92672">-</span>preload3)<span style="color:#f92672">*</span>N<span style="color:#f92672">.</span>z,wBC)
</code></pre></div><h3 id="gravity">Gravity</h3>
<p>Again, like springs, the force of gravity is conservative and should be applied to all bodies.  To globally apply the force of gravity to all particles and bodies, you can use the special <code>addforcegravity</code> method, by supplying the acceleration due to gravity as a vector.  This will get applied to all bodies defined in your system.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">system<span style="color:#f92672">.</span>addforcegravity(<span style="color:#f92672">-</span>g<span style="color:#f92672">*</span>N<span style="color:#f92672">.</span>y)
</code></pre></div><h2 id="constraints">Constraints</h2>
<p>Constraints may be defined that prevent the motion of certain elements.  Try uncommenting the commented out line to see what happens.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">eq <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">if</span> use_constraints:
    eq<span style="color:#f92672">.</span>append(pCtip<span style="color:#f92672">.</span>dot(N<span style="color:#f92672">.</span>y))
eq_d<span style="color:#f92672">=</span>[(system<span style="color:#f92672">.</span>derivative(item)) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> eq]
eq_dd<span style="color:#f92672">=</span>[(system<span style="color:#f92672">.</span>derivative(item)) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> eq_d]
</code></pre></div><h2 id="fma">F=ma</h2>
<p>This is where the symbolic expressions for F and ma are calculated.  This must be done after all parts of the system have been defined.  The <code>getdynamics</code> function uses Kane&rsquo;s method to derive the equations of motion.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">f,ma <span style="color:#f92672">=</span> system<span style="color:#f92672">.</span>getdynamics()
</code></pre></div><pre><code>2021-01-01 11:50:20,872 - pynamics.system - INFO - getting dynamic equations
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">f
</code></pre></div><pre><code>⎡          g⋅lA⋅mA⋅cos(qA)                                       g⋅lB⋅mB⋅sin(q
⎢-b⋅qA_d - ─────────────── - g⋅lA⋅mB⋅cos(qA) - g⋅lA⋅mC⋅cos(qA) + ─────────────
⎣                 2                                                         2 

A)⋅sin(qB)   g⋅lB⋅mB⋅cos(qA)⋅cos(qB)                                          
────────── - ─────────────────────── + g⋅lB⋅mC⋅sin(qA)⋅sin(qB) - g⋅lB⋅mC⋅cos(q
                        2                                                     

             g⋅lC⋅mC⋅(-sin(qB)⋅sin(qC) + cos(qB)⋅cos(qC))⋅cos(qA)   g⋅lC⋅mC⋅(-
A)⋅cos(qB) - ──────────────────────────────────────────────────── - ──────────
                                      2                                       

sin(qB)⋅cos(qC) - sin(qC)⋅cos(qB))⋅sin(qA)                                 g⋅l
────────────────────────────────────────── - k⋅(-preload₁ + qA), -b⋅qB_d + ───
               2                                                              

B⋅mB⋅sin(qA)⋅sin(qB)   g⋅lB⋅mB⋅cos(qA)⋅cos(qB)                                
──────────────────── - ─────────────────────── + g⋅lB⋅mC⋅sin(qA)⋅sin(qB) - g⋅l
        2                         2                                           

                       g⋅lC⋅mC⋅(-sin(qB)⋅sin(qC) + cos(qB)⋅cos(qC))⋅cos(qA)   
B⋅mC⋅cos(qA)⋅cos(qB) - ──────────────────────────────────────────────────── - 
                                                2                             

g⋅lC⋅mC⋅(-sin(qB)⋅cos(qC) - sin(qC)⋅cos(qB))⋅sin(qA)                          
──────────────────────────────────────────────────── - k⋅(-preload₂ + qB), -b⋅
                         2                                                    

       g⋅lC⋅mC⋅(-sin(qB)⋅sin(qC) + cos(qB)⋅cos(qC))⋅cos(qA)   g⋅lC⋅mC⋅(-sin(qB
qC_d - ──────────────────────────────────────────────────── - ────────────────
                                2                                             

)⋅cos(qC) - sin(qC)⋅cos(qB))⋅sin(qA)                     ⎤
──────────────────────────────────── - k⋅(-preload₃ + qC)⎥
         2                                               ⎦
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ma
</code></pre></div><pre><code>⎡                                                                             
⎢                                        2                                    
⎢                                      lA ⋅mA⋅qA_dd     2              2      
⎢Izz_A⋅qA_dd + Izz_B⋅(qA_dd + qB_dd) + ──────────── + lA ⋅mB⋅qA_dd + lA ⋅mC⋅qA
⎣                                           4                                 

                                                                              
                   2                                                          
      lA⋅lB⋅mB⋅qA_d ⋅sin(qB)   lA⋅lB⋅mB⋅qA_dd⋅cos(qB)   lA⋅lB⋅mB⋅(qA_d + qB_d)
_dd + ────────────────────── + ────────────────────── - ──────────────────────
                2                        2                             2      

                                                                              
2                                                                             
 ⋅sin(qB)                2                                                    
───────── + lA⋅lB⋅mC⋅qA_d ⋅sin(qB) + lA⋅lB⋅mC⋅qA_dd⋅cos(qB) - lA⋅lB⋅mC⋅(qA_d +
                                                                              

                                                                              
                                                                              
      2                 ⎛lB⋅qA_dd   lB⋅qB_dd⎞                                 
 qB_d) ⋅sin(qB) + lA⋅mB⋅⎜──────── + ────────⎟⋅cos(qB) + lA⋅mC⋅(lB⋅qA_dd + lB⋅q
                        ⎝   2          2    ⎠                                 

                                                                              
                   ⎛                            2                             
                   ⎜  lC⋅mC⋅(qA_d + qB_d + qC_d) ⋅sin(qC)      ⎛lC⋅qA_dd   lC⋅
B_dd)⋅cos(qB) + lA⋅⎜- ─────────────────────────────────── + mC⋅⎜──────── + ───
                   ⎝                   2                       ⎝   2          

                                                                              
                         ⎞              ⎛                            2        
qB_dd   lC⋅qC_dd⎞        ⎟              ⎜  lC⋅mC⋅(qA_d + qB_d + qC_d) ⋅cos(qC)
───── + ────────⎟⋅cos(qC)⎟⋅cos(qB) + lA⋅⎜- ───────────────────────────────────
2          2    ⎠        ⎠              ⎝                   2                 

                                                                              
                                              ⎞                               
      ⎛lC⋅qA_dd   lC⋅qB_dd   lC⋅qC_dd⎞        ⎟           lB⋅lC⋅mC⋅(qA_d + qB_
 - mC⋅⎜──────── + ──────── + ────────⎟⋅sin(qC)⎟⋅sin(qB) + ────────────────────
      ⎝   2          2          2    ⎠        ⎠                          2    

                                                             ⎛lB⋅qA_dd   lB⋅qB
  2                                        2           lB⋅mB⋅⎜──────── + ─────
d) ⋅sin(qC)   lB⋅lC⋅mC⋅(qA_d + qB_d + qC_d) ⋅sin(qC)         ⎝   2          2 
─────────── - ────────────────────────────────────── + ───────────────────────
                                2                                   2         

_dd⎞                                                                          
───⎟                                                                          
   ⎠                                       ⎛lC⋅qA_dd   lC⋅qB_dd   lC⋅qC_dd⎞   
──── + lB⋅mC⋅(lB⋅qA_dd + lB⋅qB_dd) + lB⋅mC⋅⎜──────── + ──────── + ────────⎟⋅co
                                           ⎝   2          2          2    ⎠   

                                                    ⎛lC⋅qA_dd   lC⋅qB_dd   lC⋅
                                              lC⋅mC⋅⎜──────── + ──────── + ───
        lC⋅mC⋅(lB⋅qA_dd + lB⋅qB_dd)⋅cos(qC)         ⎝   2          2          
s(qC) + ─────────────────────────────────── + ────────────────────────────────
                         2                                      2             

qC_dd⎞                                                                        
─────⎟      ⎛          2                              ⎞              ⎛        
2    ⎠   lC⋅⎝lA⋅mC⋅qA_d ⋅sin(qB) + lA⋅mC⋅qA_dd⋅cos(qB)⎠⋅cos(qC)   lC⋅⎝- lA⋅mC⋅
────── + ────────────────────────────────────────────────────── - ────────────
                                   2                                          

                                                                              
    2                              ⎞                                          
qA_d ⋅cos(qB) + lA⋅mC⋅qA_dd⋅sin(qB)⎠⋅sin(qC)                          lA⋅lB⋅mB
────────────────────────────────────────────, Izz_B⋅(qA_dd + qB_dd) + ────────
               2                                                              

                                                                              
     2                                                                        
⋅qA_d ⋅sin(qB)   lA⋅lB⋅mB⋅qA_dd⋅cos(qB)                2                      
────────────── + ────────────────────── + lA⋅lB⋅mC⋅qA_d ⋅sin(qB) + lA⋅lB⋅mC⋅qA
  2                        2                                                  

                                                                              
                                    2                                        2
              lB⋅lC⋅mC⋅(qA_d + qB_d) ⋅sin(qC)   lB⋅lC⋅mC⋅(qA_d + qB_d + qC_d) 
_dd⋅cos(qB) + ─────────────────────────────── - ──────────────────────────────
                             2                                    2           

                 ⎛lB⋅qA_dd   lB⋅qB_dd⎞                                        
           lB⋅mB⋅⎜──────── + ────────⎟                                        
⋅sin(qC)         ⎝   2          2    ⎠                                       ⎛
──────── + ─────────────────────────── + lB⋅mC⋅(lB⋅qA_dd + lB⋅qB_dd) + lB⋅mC⋅⎜
                        2                                                    ⎝

                                                                              
                                                                              
lC⋅qA_dd   lC⋅qB_dd   lC⋅qC_dd⎞           lC⋅mC⋅(lB⋅qA_dd + lB⋅qB_dd)⋅cos(qC) 
──────── + ──────── + ────────⎟⋅cos(qC) + ─────────────────────────────────── 
   2          2          2    ⎠                            2                  

        ⎛lC⋅qA_dd   lC⋅qB_dd   lC⋅qC_dd⎞                                      
  lC⋅mC⋅⎜──────── + ──────── + ────────⎟      ⎛          2                    
        ⎝   2          2          2    ⎠   lC⋅⎝lA⋅mC⋅qA_d ⋅sin(qB) + lA⋅mC⋅qA_
+ ────────────────────────────────────── + ───────────────────────────────────
                    2                                                2        

                                                                              
          ⎞              ⎛            2                              ⎞        
dd⋅cos(qB)⎠⋅cos(qC)   lC⋅⎝- lA⋅mC⋅qA_d ⋅cos(qB) + lA⋅mC⋅qA_dd⋅sin(qB)⎠⋅sin(qC)
─────────────────── - ────────────────────────────────────────────────────────
                                                 2                            

                                                                              
                        2                                                 lC⋅m
  lB⋅lC⋅mC⋅(qA_d + qB_d) ⋅sin(qC)   lC⋅mC⋅(lB⋅qA_dd + lB⋅qB_dd)⋅cos(qC)       
, ─────────────────────────────── + ─────────────────────────────────── + ────
                 2                                   2                        

  ⎛lC⋅qA_dd   lC⋅qB_dd   lC⋅qC_dd⎞                                            
C⋅⎜──────── + ──────── + ────────⎟      ⎛          2                          
  ⎝   2          2          2    ⎠   lC⋅⎝lA⋅mC⋅qA_d ⋅sin(qB) + lA⋅mC⋅qA_dd⋅cos
────────────────────────────────── + ─────────────────────────────────────────
              2                                                2              

                                                                        ⎤
    ⎞              ⎛            2                              ⎞        ⎥
(qB)⎠⋅cos(qC)   lC⋅⎝- lA⋅mC⋅qA_d ⋅cos(qB) + lA⋅mC⋅qA_dd⋅sin(qB)⎠⋅sin(qC)⎥
───────────── - ────────────────────────────────────────────────────────⎥
                                           2                            ⎦
</code></pre>
<h2 id="solve-for-acceleration">Solve for Acceleration</h2>
<p>The next line of code solves the system of equations F=ma plus any constraint equations that have been added above.  It returns one or two variables.  func1 is the function that computes the velocity and acceleration given a certain state, and lambda1(optional) supplies the function that computes the constraint forces as a function of the resulting states</p>
<p>There are a few ways of solveing for a.  The below function inverts the mass matrix numerically every time step.  This can be slower because the matrix solution has to be solved for, but is sometimes more tractable than solving the highly nonlinear symbolic expressions that can be generated from the previous step.  The other options would be to use <code>state_space_pre_invert</code>, which pre-inverts the equations symbolically before generating a numerical function, or <code>state_space_post_invert2</code>, which adds Baumgarte&rsquo;s method for intermittent constraints.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">func1,lambda1 <span style="color:#f92672">=</span> system<span style="color:#f92672">.</span>state_space_post_invert(f,ma,eq_dd,return_lambda <span style="color:#f92672">=</span> True)
</code></pre></div><pre><code>2021-01-01 11:50:21,341 - pynamics.system - INFO - solving a = f/m and creating function
2021-01-01 11:50:21,341 - pynamics.system - INFO - substituting constrained in Ma-f.
2021-01-01 11:50:22,112 - pynamics.system - INFO - done solving a = f/m and creating function
2021-01-01 11:50:22,116 - pynamics.system - INFO - calculating function for lambdas
</code></pre>
<h2 id="integrate">Integrate</h2>
<p>The next line of code integrates the function calculated</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">states<span style="color:#f92672">=</span>pynamics<span style="color:#f92672">.</span>integration<span style="color:#f92672">.</span>integrate(func1,ini,t,rtol<span style="color:#f92672">=</span>tol,atol<span style="color:#f92672">=</span>tol, args<span style="color:#f92672">=</span>({<span style="color:#e6db74">&#39;constants&#39;</span>:system<span style="color:#f92672">.</span>constant_values},))
</code></pre></div><pre><code>2021-01-01 11:50:22,892 - pynamics.integration - INFO - beginning integration
2021-01-01 11:50:22,908 - pynamics.system - INFO - integration at time 0000.00
2021-01-01 11:50:23,630 - pynamics.system - INFO - integration at time 0001.27
2021-01-01 11:50:24,405 - pynamics.system - INFO - integration at time 0003.06
2021-01-01 11:50:25,193 - pynamics.system - INFO - integration at time 0005.72
2021-01-01 11:50:25,791 - pynamics.system - INFO - integration at time 0009.26
2021-01-01 11:50:25,953 - pynamics.integration - INFO - finished integration
</code></pre>
<h2 id="outputs">Outputs</h2>
<p>The next section simply calculates and plots a variety of data from the previous simulation</p>
<h3 id="states">States</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure()
artists <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>plot(t,states[:,:<span style="color:#ae81ff">3</span>])
plt<span style="color:#f92672">.</span>legend(artists,[<span style="color:#e6db74">&#39;qA&#39;</span>,<span style="color:#e6db74">&#39;qB&#39;</span>,<span style="color:#e6db74">&#39;qC&#39;</span>])
</code></pre></div><pre><code>&lt;matplotlib.legend.Legend at 0x29710279cd0&gt;
</code></pre>
<p><div class="text-center">
  <a href="output_53_1.png" target="_blank"><img src="output_53_1.png" alt="png"  class="img-fluid"/></a>
</div></p>
<h3 id="energy">Energy</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">KE <span style="color:#f92672">=</span> system<span style="color:#f92672">.</span>get_KE()
PE <span style="color:#f92672">=</span> system<span style="color:#f92672">.</span>getPEGravity(pNA) <span style="color:#f92672">-</span> system<span style="color:#f92672">.</span>getPESprings()
energy_output <span style="color:#f92672">=</span> Output([KE<span style="color:#f92672">-</span>PE],system)
energy_output<span style="color:#f92672">.</span>calc(states)
energy_output<span style="color:#f92672">.</span>plot_time()
</code></pre></div><pre><code>2021-01-01 11:50:26,705 - pynamics.output - INFO - calculating outputs
2021-01-01 11:50:26,743 - pynamics.output - INFO - done calculating outputs
</code></pre>
<p><div class="text-center">
  <a href="output_55_1.png" target="_blank"><img src="output_55_1.png" alt="png"  class="img-fluid"/></a>
</div></p>
<h3 id="motion">Motion</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">points <span style="color:#f92672">=</span> [pNA,pAB,pBC,pCtip]
points_output <span style="color:#f92672">=</span> PointsOutput(points,system)
y <span style="color:#f92672">=</span> points_output<span style="color:#f92672">.</span>calc(states)
points_output<span style="color:#f92672">.</span>plot_time(<span style="color:#ae81ff">20</span>)
</code></pre></div><pre><code>2021-01-01 11:50:27,170 - pynamics.output - INFO - calculating outputs
2021-01-01 11:50:27,223 - pynamics.output - INFO - done calculating outputs





&lt;AxesSubplot:&gt;
</code></pre>
<p><div class="text-center">
  <a href="output_57_2.png" target="_blank"><img src="output_57_2.png" alt="png"  class="img-fluid"/></a>
</div></p>
<h4 id="motion-animation">Motion Animation</h4>
<p>in normal Python the next lines of code produce an animation using matplotlib</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">points_output<span style="color:#f92672">.</span>animate(fps <span style="color:#f92672">=</span> fps,movie_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;render.mp4&#39;</span>,lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;o&#39;</span>,color<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>),linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;-&#39;</span>)
</code></pre></div><pre><code>&lt;AxesSubplot:&gt;
</code></pre>
<p><div class="text-center">
  <a href="output_59_1.png" target="_blank"><img src="output_59_1.png" alt="png"  class="img-fluid"/></a>
</div></p>
<p>To plot the animation in jupyter you need a couple extra lines of code&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> animation, rc
<span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> HTML
HTML(points_output<span style="color:#f92672">.</span>anim<span style="color:#f92672">.</span>to_html5_video())
</code></pre></div><!-- raw HTML omitted -->
<h3 id="constraint-forces">Constraint Forces</h3>
<p>This line of code computes the constraint forces once the system&rsquo;s states have been solved for.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> use_constraints:
    lambda2 <span style="color:#f92672">=</span> numpy<span style="color:#f92672">.</span>array([lambda1(item1,item2,system<span style="color:#f92672">.</span>constant_values) <span style="color:#66d9ef">for</span> item1,item2 <span style="color:#f92672">in</span> zip(t,states)])
    plt<span style="color:#f92672">.</span>figure()
    plt<span style="color:#f92672">.</span>plot(t, lambda2)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
</code></pre></div>
  </article>
</main>


    
    <footer class="blog-footer">
      <p>Copyright &copy; 2021 Daniel M. Aukes.  All rights reserved.</p>
      <p><a href="#">Back to top</a></p>
    </footer>
    

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

  </body>
</html>
